---
title: スタックとは, そしてスタックマシンとはなにか

---

ここまで散々, スタックとか, スタックに積むだとか言う言葉を用いてきたが, そろそろ説明せねばなるまい.

スタックとはなにか. これはデータをちょうど積み木のように積み上げていくデータ構造のことである. スタックには次の2つの特徴がある:

1. 新しくデータを積む場合には一番上に置く
    - これを "push" という
2. データを取り出す場合には一番上のものを一つ取り出す
    - これを "pop" という

![](https://i.imgur.com/Zy9I6cH.jpg)

dc は電卓でいう「メインディスプレイ」に相当するものとして, 一つのスタックを持っている.
初期状態は, 何のデータも積まれていない空の状態である.  空のスタックにデータを積む場合には, 1つ目の積み木としてただ置くだけである.  一方で, 空のスタックからデータを取り出そうとすると, 取り出せるものが何も無いのでエラーになって操作を失敗することに注意してほしい.

さて, どうしてこんなものが必要なのかを考えることは決して無駄じゃない.  我々は急いでプログラミングを学習しているわけじゃないんだから, 腰を据えて行こう.

電卓の例に戻る.
`√` というコマンドがディスプレイに表示された（ちょうど一つの）数値に対する作用だという話はした.
ディスプレイをスタックとしたとき, まさにこのようにスタックの上に積まれたデータに対してコマンドを作用させるという計算方法がスタックマシンだ.
一方で足し算はどうだったか.
電卓では $1+2$ の計算をするのに, 計算式どおりに `1+2` と入力するだろう. この `+` の後, `2` を入力する時点でディスプレイには, ただ `2` が表示されるだけで `1` というデータが見かけ上, 消えている. しかし足し算が正しく行われているのだから, 見えていないだけでどこかに保存されているはずだ.  これがスタックの正体である. ディスプレイには常に, スタックのトップが見えているだけで, 上から2つ目は隠されているのだと思う事ができる.

![](https://i.imgur.com/P6MQaS1.jpg)

これをスタックマシンで表現したのが上の図だ.
まず, 足し算の対象である $1$ と $2$ という2つのデータをスタックに積んでいる.
そして足し算というコマンドはスタックの上から2つのデータを取り出す, つまり, 二回 pop する.
取り出された2つのデータを足した結果をスタックに戻す, つまり, push する.

このことは dc では

```bash
1 2 +
```

と表現する.  必要なデータを先に積んでから最後に操作を行っているのが `1+2` という数式通りの入力とは違う点だ.
