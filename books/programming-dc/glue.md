---
title: グルー言語としての dc

---

初めに私は awk, sed, dc を小学生に教えろと言った.
この3つで言えば優先度は dc が一番低いだろう.  プログラミングとしての自由度で言えば, awk が一番高くて, sed と dc はそれに比べればずっと低いだろう.  しかし, これらはどちらかと言えば単体で使うのではなくて他のコマンドと組み合わせて使うことが多い. いわゆる **グルー言語** としての側面が強い. そのような場合にそれぞれの得意分野を知っておくことが重要で, 場面にあわせてぴったりなツールを引っ張りだすことが出来るのが道具を「使いこなす」という意味だろう. 何でもかんでも awk で済ませればいいというわけでもないし, どんな場面でも dc を使えと言っているわけではない.

現実的には awk, sed でほとんど大抵カバーできる. これらは本当によく出来ている. この2つは行指向の言語で, [パイプ](https://en.wikipedia.org/wiki/Pipeline_(Unix)) を通じて入力を受け取って, フィルタをさせるという役割に非常に便利だ.「今から100行に渡って整数が渡されるので, それぞれを二倍したものを出力せよ」というとき, awk を使えば

```bash
(bash) $ (100行の出力) | awk '{print $1 * 2}'
```

これで済む. 便利だ.
dc では `?` を使った一行の読み込みぐらいしかない（しかも dc コマンドとして valid でないと意味がない）ので, パイプにつなげる形で使える場面はあまり多くない. 例えば「空白区切りで2つの非負整数が与えられるのでその和を出力せよ」なら,

```bash
(bash) $ echo 2 3 | dc -e ?+p
```

と書ける. awk でも

```bash
(bash) $ echo 2 3 | awk '{print $1 + $2}'
```

と書けるのでよっぽど文字数を節約したい場面でもなければ後者でいいだろう.

逆に, パイプに繋げない場合は awk, sed は不得意だ.
突然, $\sqrt{10}$ を計算したくなった. その答えがシェルスクリプトの中で欲しい, といった場合, awk ならこう書く.

```bash
(bash) $ awk 'BEGIN { print sqrt(10) }'
```

awk のただの `{}` は入力を読もうとするのに対して `BEGIN{}` は読むより前に実行される. そしてただの `{}` が無いのでこれは入力を読もうとしない. フィルタとして便利に設計されているので, 入力を読まない場合はこんな風に不自然になってしまう. そこで dc を使うと, もちろん散々見てきたように,

```bash
(bash) $ dc -e '5k 10vp'
```

と書ける. これを暗号と思うかスマートに思うかは, dc への慣れの問題だ.
10 の部分を変数に置き換える場合に, 標準入力から与えなくてもこう書いてしまってもいい.

```bash
(bash) $ X=10
(bash) $ dc -e "5k ${X}vp"
```

