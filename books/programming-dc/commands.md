---
title: コマンド体系

---

dc にどんなコマンドがあるのか, まずは雰囲気だけで眺めることにする.  電卓では数値以外は一つのボタンが一つのコマンドであるように, dc でもほとんど1文字がコマンドとして機能する.  しかし実際にはパラメータを指定するようなものもあり, その場合は複数文字からなる一つのコマンドと思ったほうが読み書きしやすいだろうから, ここではそのように説明することにする.

前章の最後にちらっと書いたように, コマンドとコマンドの間は改行で区切ってもいいし, くっつけてもいい.  或いは空白文字で区切っても（大抵のケースで）問題ないが, （まれなケースで）問題があるときもあるので, 慣れないうちは区切るなら改行ということにしてしまっていいかもしれない.  後から読みやすいように, 意味的に区切りのあるところでは改行して, また空行を入れるなどして読みやすくするとよい.

## 一文字コマンド

アルファベット一文字からなるコマンド.
例えば足し算の `+`, 前章でも使ったスタックを表示する `f` がこれ.

## 二文字コマンド

正確には一文字をパラメータとして伴う一文字のコマンドである.
ここではその中身は説明しないが, 例えば `s` というコマンドはその後ろに任意の一文字をパラメータとして取る.

```bash
> sx  # x に対して s する

> sA  # A に対して s する

> s@  # @ に対して s する
```

2文字目は ASCII 文字なら何でも良い. したがって半角スペースという文字でもいい.  先に, スペースでコマンドを区切るとたまに困ると言ったのはこれのせいだ.  逆にこの2文字目以外ならスペースは何もしないコマンドとして機能する.  そして `@` だとか `;` みたいな文字でもいいわけだが, 慣れないうちはなんだか紛らわしいので, この文章の中ではアルファベット (`a-zA-Z`) に限定しておこうと思う.

## コメント

既に登場しているが, `#` とそれより後ろの行末までの文字列はコメントとして扱われ, dc はこれを無視する.
何の計算をしているのか, 後から見た自分が分かるようにコメントを残しておくことは有益だ.

```bash
> 100vp  # この # 以降は全てコメントなので無視される

# この行もまるごと無視される
```

二文字コマンドの二文字目に `#` は正当に使うことが出来る文字であることに注意.

## 数値リテラル

整数及び浮動小数点数を記述できる. 親しんだ方法で（つまり10進数で）記述すればいい. 注意点として, 負数の頭につけるマイナスには `-` ではなく `_` を使う.  これは `-` には, 2つの値の引き算の意味しか持たされていないことによる. しょうがない.

```bash
# 整数
> 3

# 負の整数 (-3)
> _3

# 小数
> 3.14

# 負の小数
> _3.14
```

さて, 数値リテラルというコマンドが何なのかを正確に述べるなら, これはその入力した数値を「スタックに詰む」という操作である. さて, 「スタックに詰む」という言葉の説明を先延ばしてにしていながら恐縮だが, 数値を積んだ直後にまた別の数値を詰む, という操作を dc では普通に行う. これを行うには数値リテラルを2つ続けて入力すればよい.

```bash
> 10  # まず 10 を積んだ
> 20  # 次に 20 を積んだ
```

先程私は, コマンドは改行で区切らずにくっつけても良いと言った.
しかし数値リテラルがこの例外であることはお察しだろう.

```bash
> 1020  # 10 と 20 を続けて入力したが...?
```

このように書くと想定してない数値が入力されることは実行するまでも無く想像がつく.
スペースで区切っておくと, これは問題なく実行される.

```bash
> 10 20  # 10 をまず積んで, 次に 20 が積まれる
```

例外のないルールが無いように, 例外のない例外もない.
2つ目の数値が負数の場合, それは `_` から始まるわけだが,

```bash
> 10_20  # 10 を積んで次に -20 を積む
```

この場合, dc は2つの数値に区切ることが出来るので, くっつけてしまっても問題ない.

## 文字列リテラル

ここからようやく, 電卓より出来ることが多いという, その部分に突入する.
dc は文字列をデータとして持つことが出来る.  文字列は `[` と `]` で括って記述する.

```bash
[abc]  # "abc" という三文字を表すデータ
```

文字列リテラルをコマンドとして実行すると, 数値を入力した場合とちょうど同じように, データを「スタックに積む」という操作をしてくれる. ここで新たな一文字コマンドを紹介する. `p` は直前に積んだデータ1つを表示するコマンドである. これを使うと,

```bash
> 3.14p
3.14

> [Hello World]p
Hello World
```

と, 画面への print を行うことが出来る.
`p` と `f` の違いはスタックに関わる話なので, まだもう少し先延ばししたい.

さて, ここからが dc をプログラミング言語だと言い張ってしまう根拠なのだが, dc は文字列データ自体を dc のコマンドとして実行することが出来る. いくつかのスクリプト言語をあなたが知っているなら, eval をする, と言えば伝わるだろうか.

```bash
> 100vp  # 100 を入れて平方根を取って, それを print する
10
```

ここで `100vp` という文字列が dc として正当なコマンド（プログラムコード）である. これを文字列データとして入力して実行するには `x` コマンドを使う.

```bash
> [100vp]  # 文字列データを積む
> p        # print してみると確かに文字列が入ってる
100vp
> x        # これを実行する
10         # された!
```

文字列データ自体はどんな文字列でも持つことが出来るから, dc のコマンドとして不正なものかもしれない. そのようなものを実行しようとすると, これはエラーになる.

```bash
> [HELLO]
> x
dc: 'H' (0110) unimplemented
dc: stack register 'L' (0114) is empty
```

さて, 直前に書いたコードを `x` でただ一回実行するだけなら, そんな回りくどいことをせずに直接コマンド入力して実行すればよいだろう. 真髄は, 一つのコードを反復実行する, 条件分岐で実行する, という, プログラムとして最低限の機能を提供していることにある. これによって dc は, 電卓では実現困難な計算をたやすく実行できる.

